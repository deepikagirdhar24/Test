@Then("I verify the following fields in Update Natural Person response")
public void verifyUpdateNaturalPersonFields(DataTable dataTable, ScenarioContext scenarioContext) {
    Map<String, String> expectedValues = dataTable.asMap(String.class, String.class);

    for (Map.Entry<String, String> entry : expectedValues.entrySet()) {
        String responseKey = entry.getKey();
        String expectedValue = entry.getValue();

        // ðŸ”¹ Check if expectedValue is a placeholder from ScenarioContext
        if (expectedValue.startsWith("SC:")) {
            String contextKey = expectedValue.replace("SC:", "").trim();
            expectedValue = scenarioContext.getContext(contextKey);
        }

        String actualValue = jsonHelper.getValue(response, responseKey);

        ExtentCucumberAdapter.addTestStepLog(
                "Validating field: '" + responseKey +
                "' | Expected: '" + expectedValue +
                "' | Actual: '" + actualValue + "'"
        );

        Assert.assertEquals(
                actualValue,
                expectedValue,
                "Mismatch for field: " + responseKey
        );
    }
}

SC:updNaturalPersonObjectId
SC:updNaturalPersonObjectId
