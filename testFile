@And("I verify the validation error response with description {string} and error message {string}")
public void iVerifyTheValidationErrorResponse(String expectedDescription, String expectedErrorMessage) throws Exception {
    String actualDescription = JsonHelper.extractStringField(response, "description");
    ExtentCucumberAdapter.addTestStepLog("Actual description: " + actualDescription);
    Assert.assertEquals(actualDescription, expectedDescription, "Mismatch in description");

    // Extracting the first validation error message
    String actualErrorMessage = JsonHelper.extractStringFieldFromArray(response, "validationErrors", 0, "error");
    ExtentCucumberAdapter.addTestStepLog("Actual error message: " + actualErrorMessage);
    Assert.assertEquals(actualErrorMessage, expectedErrorMessage, "Mismatch in error message");
}


public static String extractStringFieldFromArray(Response response, String arrayField, int index, String fieldName) {
    return response.jsonPath().getString(arrayField + "[" + index + "]." + fieldName);
}

Feature: Create Contact Notes API with invalid PersonId

  Scenario Outline: Verify the Post Contact Notes API with invalid PersonId
    Given Send Request to get Authentication Token for ICOS
    When I generate the JWT Token
    Then Send POST ContactNote Request with below details
      | personIds    | ghgf            |
      | subject      | Testsubject     |
      | notes        | Testnote        |
      | hasFollowup  | false           |
    And I verify the Status Code for Contact Notes "<statusCode>"
    And And I verify the validation error response with below details
      | description   | Validation Errors |
      | error message | Person not found  |

    Examples:
      | statusCode |
      | 400        |

