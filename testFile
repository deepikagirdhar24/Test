String strNationalities = mapPersonDetails.get("nationalities");
List<String> lstNationality = new ArrayList<>();

if (strNationalities != null && !strNationalities.trim().isEmpty()) {
    ObjectMapper objectMapper = new ObjectMapper();
    try {
        // Try parsing as a JSON array
        lstNationality = objectMapper.readValue(strNationalities, List.class);
    } catch (Exception e) {
        // Fallback: comma-separated string
        lstNationality = Arrays.stream(strNationalities.split(","))
            .map(String::trim)
            .filter(s -> !s.isEmpty())
            .collect(Collectors.toList());
    }
}
personRequest.setLstNationalities(lstNationality);
