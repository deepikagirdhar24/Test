// Method to extract a value from JSON by key
public String extractStringField(Response response, String key) throws JsonProcessingException {
    JsonNode rootNode = objectMapper.readTree(response.asString());
    return rootNode.path(key).asText();
}

public Boolean extractBooleanField(Response response, String key) throws JsonProcessingException {
    JsonNode rootNode = objectMapper.readTree(response.asString());
    return rootNode.path(key).asBoolean();
}

// Generic method to check if a value exists in a JSON array at the given JSON path
public boolean valueExistsInJsonArray(Response response, String jsonPath, String targetValue) throws JsonProcessingException {
    JsonNode rootNode = objectMapper.readTree(response.asString());
    JsonNode arrayNode = rootNode.path(jsonPath);
    if (arrayNode.isArray()) {
        return iterateAndCheckArray(arrayNode, targetValue);
    }
    return false;
}

// Loop function used to check each item in the JSON array
public boolean iterateAndCheckArray(JsonNode arrayNode, String targetValue) {
    for (JsonNode itemNode : arrayNode) {
        String currentValue = itemNode.asText();
        objCucumberLogger.PrintStatus("Checking item: " + currentValue); // Debugging line
        if (targetValue.equals(currentValue)) {
            logMatchFound(currentValue);
            return true;
        }
    }
    return false;
}

// Logger method to add report entry for matched item
private void logMatchFound(String value) {
    objCucumberLogger.PrintStatus("Match found: " + value);
    ExtentCucumberAdapter.addTestStepLog("Actual value found: " + value);
}

// Specific usage example: Check if a personId exists
public boolean personIdExists(Response response, String personId) throws JsonProcessingException {
    return valueExistsInJsonArray(response, "personIds", personId);
}

// Specific usage example: Check if an orderId exists
public boolean orderIdExists(Response response, String orderId) throws JsonProcessingException {
    return valueExistsInJsonArray(response, "orderIds", orderId);
}
********************************************************************************************************




@And("I verify the Subject {string}")
    public void iVerifyTheSubject(String subject) throws JsonProcessingException {
        String stringValueSubject=objContactNotes.getSubject(response);
        ExtentCucumberAdapter.addTestStepLog("Actual value of Subject is : " +stringValueSubject);
        Assert.assertEquals(subject,stringValueSubject);
    }

    @And("I verify the Notes {string}")
    public void iVerifyTheNotes(String notes) throws JsonProcessingException {
        String stringValueNotes=objContactNotes.getNotes(response);
        ExtentCucumberAdapter.addTestStepLog("Actual value of Notes is : " +stringValueNotes);
        Assert.assertEquals(notes,stringValueNotes);
    }

    @And("I verify the HasFollowup {string}")
    public void iVerifyTheHasFollowup(String hasFollowup) throws JsonProcessingException {
        ExtentCucumberAdapter.addTestStepLog("Actual value of HasFollowUp is : " +objContactNotes.hasFollowup(response));
        Assert.assertEquals(true,objContactNotes.hasFollowup(response));
    }

    @And("I verify the Person Item {string}")
    public void iVerifyThePersonItem(String personItem) throws JsonProcessingException {
        boolean boolHasPersonItem = objContactNotes.getPersonItem(response, personItem);
        Assert.assertEquals(true, boolHasPersonItem);
    }



@And("I verify the Status Code for Contact Notes {string}")
    public void iVerifyTheStatusCodeForContactNotes(String strStatusCode) {
        int responseCode= response.statusCode();
        ExtentCucumberAdapter.addTestStepLog("Actual value of Status code is : " +responseCode);
        Assert.assertEquals(Integer.parseInt(strStatusCode),responseCode);
    }

// New method to get Subject from the JSON
    public String getSubject(Response response) throws JsonProcessingException {
        JsonNode rootNode = objectMapper.readTree(response.asString());
        return rootNode.path("subject").asText();
    }

    // New method to get Notes from the JSON
    public String getNotes(Response response) throws JsonProcessingException {
        JsonNode rootNode = objectMapper.readTree(response.asString());
        return rootNode.path("notes").asText();
    }

    // New method to get hasFollowUp from the JSON
    public Boolean hasFollowup(Response response) throws JsonProcessingException {
        JsonNode rootNode = objectMapper.readTree(response.asString());
        return rootNode.path("hasFollowup").asBoolean();
    }

    public boolean getPersonItem(Response response, String personItem) throws JsonProcessingException {
        JsonNode rootNode = objectMapper.readTree(response.asString());
        JsonNode personIdsNode = rootNode.path("personIds");
        if (personIdsNode.isArray()) {
            for (JsonNode itemNode : personIdsNode) {
                String currentId = itemNode.asText();
                objCucumberLogger.PrintStatus("Checking item: " + currentId); // Debugging line
                if (personItem.equals(currentId)) {
                    objCucumberLogger.PrintStatus("Match found: " + currentId); // Debugging line
                    ExtentCucumberAdapter.addTestStepLog("Actual value of Person Item is : " +currentId);
                    return true;
                }
            }
        }
        return false;
    }

My Senior has reviewed this and added below comments for me to implement.Please add this my above code - 

I have refactored this code, please follow this for future:
// Generic function to check if a value exists in a JSON array public boolean valueExistsInJsonArray(Response response, String jsonPath, String targetValue) throws JsonProcessingException { JsonNode rootNode = objectMapper.readTree(response.asString()); JsonNode arrayNode = rootNode.path(jsonPath);
if (arrayNode.isArray()) {
    return iterateAndCheckArray(arrayNode, targetValue);
}
return false;
}
// The Loop Function which should be called from step definition public boolean iterateAndCheckArray(JsonNode arrayNode, String targetValue) { for (JsonNode itemNode : arrayNode) { String currentValue = itemNode.asText(); if (targetValue.equals(currentValue)) { logMatchFound(currentValue); return true; } } return false; }
// Here you can create a separate function to add some time in reports. This can be added in Base Step
private void logMatchFound(String value) { objCucumberLogger.PrintStatus("Match found: " + value); ExtentCucumberAdapter.addTestStepLog("Actual value found: " + value); }
// Example usage for person IDs public boolean personIdExists(Response response, String personId) throws JsonProcessingException { return valueExistsInJsonArray(response, "personIds", personId); }
// Example usage for other entity types public boolean orderIdExists(Response response, String orderId) throws JsonProcessingException { return valueExistsInJsonArray(response, "orderIds", orderId); }
In my opinion i found these issues here :
1.Function only works with "personIds" and cannot be reused for other JSON paths 2. "personIds" is hardcoded, limiting reusability 4. Naming Inconsistency- Named "getPersonItem" but actually performs validation 5. The iteration logic should have been written better for reusuability
